<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light">
    <title>★ sxtp ★ gallery</title>
    <link rel="stylesheet" href="../css/index.css">
    <link rel="stylesheet" href="../css/gallery.css">
    <link rel="icon" href="../images/favicon.ico">
</head>

<body>
    <!-- Top Navigation -->
    <nav class="top-nav">
        <div class="nav-item" id="logo-container">
            <a href="../index.html"><div id="logo">$xtp</div></a>
        </div>
        <div class="nav-item nav-link" data-section="vision">gallery</div>
        <div class="nav-item nav-link" data-section="audio">audio</div>
        <div class="nav-item nav-link play-btn" data-section="play">play!</div>
        <div class="nav-item volume-control">
            <span class="volume-label">vol:</span>
            <input type="range" id="volume-slider" min="0" max="100" value="60" class="retro-slider">
            <span id="volume-display" class="volume-value">100%</span>
        </div>
        <div class="nav-item timestamp">
            <span id="live-time"></span>
        </div>
    </nav>

    <!-- Gallery Content -->
    <main class="gallery-container">
        <h1 class="gallery-title">GALLERY</h1>
        <div class="gallery-grid" id="gallery-grid">
            <!-- Images will be loaded dynamically -->
        </div>
    </main>

    <!-- News Ticker Footer -->
    <footer class="news-footer">
        <a class="ticker" href="https://www.passline.com/eventos/tarea-fina-en-tucuman">
            ★★★ NUEVO EP DISPONIBLE ★★★ MDQ 30/01 ENTRADAS ACÁ ★★★ METAL VIOLADO ★★★ 
        </a>
    </footer>

    <audio id="audio-player" src="../audio/sexo-debil.mp3" preload="auto"></audio>

    <script src="../scripts/script.js"></script>
    <script>
        // Dynamically load all images from gallery folder
        const galleryGrid = document.getElementById('gallery-grid');
        
        // Function to attempt loading images by number
        async function loadGalleryImages() {
            const loadedImages = [];
            let imageNumber = 1;
            let consecutiveFails = 0;
            
            // Try to load images from 1 to 100 (or until we hit 5 consecutive failures)
            while (consecutiveFails < 5 && imageNumber <= 100) {
                const imagePath = `../images/gallery/${imageNumber}.jpg`;
                
                try {
                    // Try to load the image
                    const response = await fetch(imagePath, { method: 'HEAD' });
                    
                    if (response.ok) {
                        loadedImages.push(imageNumber);
                        consecutiveFails = 0;
                    } else {
                        consecutiveFails++;
                    }
                } catch (error) {
                    consecutiveFails++;
                }
                
                imageNumber++;
            }
            
            // Create gallery items for all found images
            loadedImages.forEach(num => {
                const galleryItem = document.createElement('div');
                galleryItem.className = 'gallery-item';
                
                const img = document.createElement('img');
                img.src = `../images/gallery/${num}.jpg`;
                img.alt = `gallery image ${num}`;
                
                galleryItem.appendChild(img);
                galleryGrid.appendChild(galleryItem);
            });
            
            // Set up fullscreen functionality after images are loaded
            setupFullscreen();
        }
        
        function setupFullscreen() {
            const galleryItems = document.querySelectorAll('.gallery-item img');
        
            galleryItems.forEach(img => {
                img.addEventListener('click', function(e) {
                    e.stopPropagation();
                    
                    // Create fullscreen overlay
                    const fullscreen = document.createElement('div');
                    fullscreen.className = 'gallery-fullscreen';
                    
                    const fullscreenImg = document.createElement('img');
                    fullscreenImg.src = this.src;
                    fullscreenImg.alt = this.alt;
                    
                    fullscreen.appendChild(fullscreenImg);
                    document.body.appendChild(fullscreen);
                    
                    // Close on click
                    fullscreen.addEventListener('click', function() {
                        fullscreen.remove();
                    });
                    
                    // Close on ESC key
                    const escHandler = function(e) {
                        if (e.key === 'Escape') {
                            fullscreen.remove();
                            document.removeEventListener('keydown', escHandler);
                        }
                    };
                    document.addEventListener('keydown', escHandler);
                });
            });
        }
        
        // Load images on page load
        loadGalleryImages();
    </script>
</body>

</html>
